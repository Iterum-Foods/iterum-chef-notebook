<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mobile Responsiveness Test - Iterum</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background: #f5f5f5;
        }
        .test-section {
            background: white;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .test-button {
            background: #3b82f6;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
            font-size: 14px;
        }
        .test-button:hover {
            background: #2563eb;
        }
        .test-button:disabled {
            background: #9ca3af;
            cursor: not-allowed;
        }
        .test-button.success {
            background: #10b981;
        }
        .test-button.success:hover {
            background: #059669;
        }
        .test-button.warning {
            background: #f59e0b;
        }
        .test-button.warning:hover {
            background: #d97706;
        }
        .test-result {
            margin: 10px 0;
            padding: 10px;
            border-radius: 5px;
        }
        .success {
            background: #d1fae5;
            color: #065f46;
            border: 1px solid #a7f3d0;
        }
        .error {
            background: #fee2e2;
            color: #991b1b;
            border: 1px solid #fca5a5;
        }
        .info {
            background: #dbeafe;
            color: #1e40af;
            border: 1px solid #93c5fd;
        }
        .loading {
            background: #fef3c7;
            color: #92400e;
            border: 1px solid #fde68a;
        }
        .warning {
            background: #fef3c7;
            color: #92400e;
            border: 1px solid #fde68a;
        }
        .device-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        .device-card {
            background: #f8fafc;
            padding: 15px;
            border-radius: 8px;
            border: 1px solid #e5e7eb;
        }
        .device-card h4 {
            margin: 0 0 10px 0;
            color: #1f2937;
        }
        .device-status {
            font-size: 12px;
            padding: 5px 10px;
            border-radius: 3px;
            display: inline-block;
            margin: 5px 0;
        }
        .status-pass {
            background: #d1fae5;
            color: #065f46;
        }
        .status-fail {
            background: #fee2e2;
            color: #991b1b;
        }
        .status-pending {
            background: #fef3c7;
            color: #92400e;
        }
        .mobile-test-area {
            background: #f3f4f6;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
            min-height: 200px;
        }
        .touch-test {
            background: #e5e7eb;
            padding: 20px;
            border-radius: 8px;
            margin: 10px 0;
            text-align: center;
            cursor: pointer;
            user-select: none;
        }
        .touch-test:active {
            background: #d1d5db;
        }
        .form-test {
            background: white;
            padding: 20px;
            border-radius: 8px;
            border: 1px solid #e5e7eb;
            margin: 20px 0;
        }
        .form-input {
            width: 100%;
            padding: 12px;
            border: 1px solid #d1d5db;
            border-radius: 5px;
            font-size: 16px;
            margin: 10px 0;
            box-sizing: border-box;
        }
        .form-input:focus {
            outline: none;
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }
        .modal-test {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }
        .modal-content {
            background: white;
            padding: 20px;
            border-radius: 8px;
            max-width: 90%;
            max-height: 90%;
            overflow-y: auto;
        }
        .test-data {
            background: #f3f4f6;
            padding: 15px;
            border-radius: 5px;
            margin: 10px 0;
            font-family: monospace;
            font-size: 12px;
            max-height: 200px;
            overflow-y: auto;
        }
        .progress-bar {
            width: 100%;
            height: 20px;
            background: #e5e7eb;
            border-radius: 10px;
            overflow: hidden;
            margin: 10px 0;
        }
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #3b82f6, #10b981);
            transition: width 0.3s ease;
        }
        
        /* Mobile-specific styles */
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            .test-section {
                padding: 15px;
                margin: 15px 0;
            }
            .device-grid {
                grid-template-columns: 1fr;
            }
            .test-button {
                width: 100%;
                margin: 5px 0;
            }
        }
        
        @media (max-width: 480px) {
            .test-section {
                padding: 10px;
            }
            .form-input {
                font-size: 16px; /* Prevents zoom on iOS */
            }
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>📱 Mobile Responsiveness Test</h1>
        <p>This page tests the mobile responsiveness and touch interactions for the Iterum app.</p>
        
        <div id="status" class="test-result info">
            Initializing mobile responsiveness test...
        </div>
        
        <!-- Test Progress -->
        <div class="test-section">
            <h2>Test Progress</h2>
            <div class="progress-bar">
                <div id="progress-fill" class="progress-fill" style="width: 0%"></div>
            </div>
            <div id="progress-text">0% Complete</div>
        </div>
        
        <!-- Device Detection -->
        <div class="test-section">
            <h2>Device Detection</h2>
            <button onclick="testDeviceDetection()" class="test-button">Test Device Detection</button>
            <button onclick="testScreenSize()" class="test-button">Test Screen Size</button>
            <button onclick="testOrientation()" class="test-button">Test Orientation</button>
            <div id="device-info" class="test-data">
                No device info yet...
            </div>
        </div>
        
        <!-- Touch Interaction Tests -->
        <div class="test-section">
            <h2>Touch Interaction Tests</h2>
            <div class="mobile-test-area">
                <h3>Touch Test Area</h3>
                <div class="touch-test" onclick="testTouch('tap')" ontouchend="testTouch('tap')">
                    Tap Test - Click or Touch Here
                </div>
                <div class="touch-test" onmousedown="testTouch('press')" ontouchstart="testTouch('press')">
                    Press Test - Hold Here
                </div>
                <div class="touch-test" onmousemove="testTouch('move')" ontouchmove="testTouch('move')">
                    Move Test - Move Mouse/Finger Here
                </div>
            </div>
            <div id="touch-results"></div>
        </div>
        
        <!-- Mobile Form Tests -->
        <div class="test-section">
            <h2>Mobile Form Tests</h2>
            <div class="form-test">
                <h3>Mobile Form Test</h3>
                <input type="text" class="form-input" placeholder="Text input test" id="text-input">
                <input type="email" class="form-input" placeholder="Email input test" id="email-input">
                <input type="password" class="form-input" placeholder="Password input test" id="password-input">
                <input type="number" class="form-input" placeholder="Number input test" id="number-input">
                <textarea class="form-input" placeholder="Textarea test" rows="3" id="textarea-input"></textarea>
                <button onclick="testFormSubmission()" class="test-button success">Test Form Submission</button>
            </div>
            <div id="form-results"></div>
        </div>
        
        <!-- Mobile Modal Tests -->
        <div class="test-section">
            <h2>Mobile Modal Tests</h2>
            <button onclick="testMobileModal()" class="test-button">Test Mobile Modal</button>
            <button onclick="testModalSizing()" class="test-button">Test Modal Sizing</button>
            <button onclick="testModalDismissal()" class="test-button">Test Modal Dismissal</button>
            <div id="modal-results"></div>
        </div>
        
        <!-- Mobile Navigation Tests -->
        <div class="test-section">
            <h2>Mobile Navigation Tests</h2>
            <button onclick="testMobileNavigation()" class="test-button">Test Mobile Navigation</button>
            <button onclick="testBackButton()" class="test-button">Test Back Button</button>
            <button onclick="testDeepLinking()" class="test-button">Test Deep Linking</button>
            <div id="navigation-results"></div>
        </div>
        
        <!-- Mobile Performance Tests -->
        <div class="test-section">
            <h2>Mobile Performance Tests</h2>
            <button onclick="testMobilePerformance()" class="test-button">Test Mobile Performance</button>
            <button onclick="testNetworkConditions()" class="test-button">Test Network Conditions</button>
            <button onclick="testMemoryUsage()" class="test-button">Test Memory Usage</button>
            <div id="performance-results"></div>
        </div>
        
        <!-- Device-Specific Tests -->
        <div class="test-section">
            <h2>Device-Specific Tests</h2>
            <div class="device-grid" id="device-grid">
                <!-- Device cards will be populated dynamically -->
            </div>
        </div>
        
        <!-- Test Results -->
        <div class="test-section">
            <h2>Test Results</h2>
            <div id="test-results"></div>
        </div>
        
        <!-- Test Data Display -->
        <div class="test-section">
            <h2>Mobile Test Data</h2>
            <div id="test-data-display" class="test-data">
                No mobile test data yet...
            </div>
        </div>
    </div>

    <!-- Mobile Modal -->
    <div id="mobile-modal" class="modal-test">
        <div class="modal-content">
            <h3>Mobile Modal Test</h3>
            <p>This is a test modal for mobile responsiveness.</p>
            <p>It should be properly sized and positioned on mobile devices.</p>
            <button onclick="closeMobileModal()" class="test-button">Close Modal</button>
        </div>
    </div>

    <!-- Load required scripts -->
    <script src="assets/js/firebase-config.js"></script>
    <script type="module" src="assets/js/firebase-auth.js"></script>
    <script type="module" src="assets/js/firebase-auth-ui.js"></script>
    <script src="assets/js/unified_auth_system.js"></script>
    <script src="assets/js/project-management-system.js"></script>

    <script>
        let testResults = [];
        let mobileData = {};
        let touchEvents = [];
        
        // Initialize test
        window.addEventListener('load', async () => {
            updateStatus('Initializing mobile responsiveness test...', 'loading');
            
            // Wait for systems to initialize
            await new Promise(resolve => setTimeout(resolve, 2000));
            
            if (window.unifiedAuthSystem && window.projectManager) {
                updateStatus('✅ Mobile responsiveness test ready!', 'success');
                initializeDeviceGrid();
                testDeviceDetection();
            } else {
                updateStatus('❌ Required systems not available', 'error');
            }
        });
        
        function updateStatus(message, type) {
            const statusDiv = document.getElementById('status');
            statusDiv.textContent = message;
            statusDiv.className = `test-result ${type}`;
        }
        
        function updateProgress(percentage) {
            document.getElementById('progress-fill').style.width = percentage + '%';
            document.getElementById('progress-text').textContent = percentage + '% Complete';
        }
        
        function addTestResult(test, status, details) {
            testResults.push({ test, status, details, timestamp: new Date() });
            updateTestResults();
        }
        
        function updateTestResults() {
            const resultsDiv = document.getElementById('test-results');
            let html = '<h3>Test Results:</h3>';
            
            testResults.forEach((result, index) => {
                const statusClass = result.status === 'PASS' ? 'success' : 'error';
                const statusIcon = result.status === 'PASS' ? '✅' : '❌';
                html += `
                    <div class="test-result ${statusClass}">
                        <strong>${statusIcon} ${result.test}</strong><br>
                        <small>${result.details}</small><br>
                        <small>Time: ${result.timestamp.toLocaleTimeString()}</small>
                    </div>
                `;
            });
            
            resultsDiv.innerHTML = html;
        }
        
        function testDeviceDetection() {
            updateStatus('Testing device detection...', 'loading');
            
            try {
                const userAgent = navigator.userAgent;
                const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(userAgent);
                const isTablet = /iPad|Android(?=.*Mobile)/i.test(userAgent);
                const isTouch = 'ontouchstart' in window || navigator.maxTouchPoints > 0;
                
                const deviceInfo = {
                    userAgent: userAgent,
                    isMobile: isMobile,
                    isTablet: isTablet,
                    isTouch: isTouch,
                    screenWidth: window.screen.width,
                    screenHeight: window.screen.height,
                    windowWidth: window.innerWidth,
                    windowHeight: window.innerHeight,
                    pixelRatio: window.devicePixelRatio,
                    orientation: screen.orientation ? screen.orientation.type : 'unknown'
                };
                
                mobileData.deviceInfo = deviceInfo;
                updateMobileData();
                
                addTestResult('Device Detection', 'PASS', `Mobile: ${isMobile}, Tablet: ${isTablet}, Touch: ${isTouch}`);
                updateStatus('✅ Device detection test completed!', 'success');
                
            } catch (error) {
                addTestResult('Device Detection', 'FAIL', `Error: ${error.message}`);
                updateStatus(`❌ Device detection test failed: ${error.message}`, 'error');
            }
        }
        
        function testScreenSize() {
            updateStatus('Testing screen size...', 'loading');
            
            try {
                const screenInfo = {
                    width: window.innerWidth,
                    height: window.innerHeight,
                    screenWidth: window.screen.width,
                    screenHeight: window.screen.height,
                    pixelRatio: window.devicePixelRatio,
                    breakpoint: getBreakpoint()
                };
                
                mobileData.screenInfo = screenInfo;
                updateMobileData();
                
                addTestResult('Screen Size', 'PASS', `${screenInfo.width}x${screenInfo.height} (${screenInfo.breakpoint})`);
                updateStatus('✅ Screen size test completed!', 'success');
                
            } catch (error) {
                addTestResult('Screen Size', 'FAIL', `Error: ${error.message}`);
                updateStatus(`❌ Screen size test failed: ${error.message}`, 'error');
            }
        }
        
        function testOrientation() {
            updateStatus('Testing orientation...', 'loading');
            
            try {
                const orientation = screen.orientation ? screen.orientation.type : 'unknown';
                const isPortrait = window.innerHeight > window.innerWidth;
                
                addTestResult('Orientation', 'PASS', `${orientation} (Portrait: ${isPortrait})`);
                updateStatus('✅ Orientation test completed!', 'success');
                
            } catch (error) {
                addTestResult('Orientation', 'FAIL', `Error: ${error.message}`);
                updateStatus(`❌ Orientation test failed: ${error.message}`, 'error');
            }
        }
        
        function getBreakpoint() {
            const width = window.innerWidth;
            if (width < 480) return 'xs';
            if (width < 768) return 'sm';
            if (width < 1024) return 'md';
            if (width < 1280) return 'lg';
            return 'xl';
        }
        
        function testTouch(eventType) {
            touchEvents.push({
                type: eventType,
                timestamp: new Date(),
                x: event.clientX || 0,
                y: event.clientY || 0
            });
            
            addTestResult(`Touch ${eventType}`, 'PASS', `Touch event detected at (${event.clientX || 0}, ${event.clientY || 0})`);
            updateTouchResults();
        }
        
        function updateTouchResults() {
            const resultsDiv = document.getElementById('touch-results');
            let html = '<h3>Touch Events:</h3>';
            
            touchEvents.forEach((event, index) => {
                html += `
                    <div class="test-result info">
                        <strong>${event.type}</strong> at ${event.timestamp.toLocaleTimeString()}<br>
                        <small>Position: (${event.x}, ${event.y})</small>
                    </div>
                `;
            });
            
            resultsDiv.innerHTML = html;
        }
        
        function testFormSubmission() {
            updateStatus('Testing form submission...', 'loading');
            
            try {
                const formData = {
                    text: document.getElementById('text-input').value,
                    email: document.getElementById('email-input').value,
                    password: document.getElementById('password-input').value,
                    number: document.getElementById('number-input').value,
                    textarea: document.getElementById('textarea-input').value
                };
                
                addTestResult('Form Submission', 'PASS', `Form data collected: ${Object.keys(formData).length} fields`);
                updateStatus('✅ Form submission test completed!', 'success');
                
            } catch (error) {
                addTestResult('Form Submission', 'FAIL', `Error: ${error.message}`);
                updateStatus(`❌ Form submission test failed: ${error.message}`, 'error');
            }
        }
        
        function testMobileModal() {
            updateStatus('Testing mobile modal...', 'loading');
            
            try {
                const modal = document.getElementById('mobile-modal');
                modal.style.display = 'flex';
                
                addTestResult('Mobile Modal', 'PASS', 'Modal opened successfully');
                updateStatus('✅ Mobile modal test completed!', 'success');
                
            } catch (error) {
                addTestResult('Mobile Modal', 'FAIL', `Error: ${error.message}`);
                updateStatus(`❌ Mobile modal test failed: ${error.message}`, 'error');
            }
        }
        
        function closeMobileModal() {
            const modal = document.getElementById('mobile-modal');
            modal.style.display = 'none';
        }
        
        function testModalSizing() {
            updateStatus('Testing modal sizing...', 'loading');
            
            try {
                const modal = document.getElementById('mobile-modal');
                const content = modal.querySelector('.modal-content');
                const rect = content.getBoundingClientRect();
                
                addTestResult('Modal Sizing', 'PASS', `Modal size: ${rect.width}x${rect.height}`);
                updateStatus('✅ Modal sizing test completed!', 'success');
                
            } catch (error) {
                addTestResult('Modal Sizing', 'FAIL', `Error: ${error.message}`);
                updateStatus(`❌ Modal sizing test failed: ${error.message}`, 'error');
            }
        }
        
        function testModalDismissal() {
            updateStatus('Testing modal dismissal...', 'loading');
            
            try {
                closeMobileModal();
                addTestResult('Modal Dismissal', 'PASS', 'Modal closed successfully');
                updateStatus('✅ Modal dismissal test completed!', 'success');
                
            } catch (error) {
                addTestResult('Modal Dismissal', 'FAIL', `Error: ${error.message}`);
                updateStatus(`❌ Modal dismissal test failed: ${error.message}`, 'error');
            }
        }
        
        function testMobileNavigation() {
            updateStatus('Testing mobile navigation...', 'loading');
            
            try {
                // Test if navigation elements are accessible
                const navElements = document.querySelectorAll('nav, .nav, .navigation');
                addTestResult('Mobile Navigation', 'PASS', `Found ${navElements.length} navigation elements`);
                updateStatus('✅ Mobile navigation test completed!', 'success');
                
            } catch (error) {
                addTestResult('Mobile Navigation', 'FAIL', `Error: ${error.message}`);
                updateStatus(`❌ Mobile navigation test failed: ${error.message}`, 'error');
            }
        }
        
        function testBackButton() {
            updateStatus('Testing back button...', 'loading');
            
            try {
                // Test if back button functionality is available
                if (window.history && window.history.back) {
                    addTestResult('Back Button', 'PASS', 'Back button functionality available');
                    updateStatus('✅ Back button test completed!', 'success');
                } else {
                    addTestResult('Back Button', 'FAIL', 'Back button functionality not available');
                    updateStatus('❌ Back button test failed - back button not available', 'error');
                }
                
            } catch (error) {
                addTestResult('Back Button', 'FAIL', `Error: ${error.message}`);
                updateStatus(`❌ Back button test failed: ${error.message}`, 'error');
            }
        }
        
        function testDeepLinking() {
            updateStatus('Testing deep linking...', 'loading');
            
            try {
                // Test if URL can be modified for deep linking
                const currentUrl = window.location.href;
                addTestResult('Deep Linking', 'PASS', `Current URL: ${currentUrl}`);
                updateStatus('✅ Deep linking test completed!', 'success');
                
            } catch (error) {
                addTestResult('Deep Linking', 'FAIL', `Error: ${error.message}`);
                updateStatus(`❌ Deep linking test failed: ${error.message}`, 'error');
            }
        }
        
        function testMobilePerformance() {
            updateStatus('Testing mobile performance...', 'loading');
            
            try {
                const startTime = performance.now();
                
                // Simulate some work
                setTimeout(() => {
                    const endTime = performance.now();
                    const duration = endTime - startTime;
                    
                    addTestResult('Mobile Performance', 'PASS', `Performance test completed in ${duration.toFixed(2)}ms`);
                    updateStatus('✅ Mobile performance test completed!', 'success');
                }, 100);
                
            } catch (error) {
                addTestResult('Mobile Performance', 'FAIL', `Error: ${error.message}`);
                updateStatus(`❌ Mobile performance test failed: ${error.message}`, 'error');
            }
        }
        
        function testNetworkConditions() {
            updateStatus('Testing network conditions...', 'loading');
            
            try {
                if (navigator.connection) {
                    const connection = navigator.connection;
                    addTestResult('Network Conditions', 'PASS', `Connection: ${connection.effectiveType || 'unknown'}`);
                } else {
                    addTestResult('Network Conditions', 'FAIL', 'Network information not available');
                }
                
                updateStatus('✅ Network conditions test completed!', 'success');
                
            } catch (error) {
                addTestResult('Network Conditions', 'FAIL', `Error: ${error.message}`);
                updateStatus(`❌ Network conditions test failed: ${error.message}`, 'error');
            }
        }
        
        function testMemoryUsage() {
            updateStatus('Testing memory usage...', 'loading');
            
            try {
                if (performance.memory) {
                    const memory = performance.memory;
                    addTestResult('Memory Usage', 'PASS', `Used: ${(memory.usedJSHeapSize / 1024 / 1024).toFixed(2)}MB`);
                } else {
                    addTestResult('Memory Usage', 'FAIL', 'Memory information not available');
                }
                
                updateStatus('✅ Memory usage test completed!', 'success');
                
            } catch (error) {
                addTestResult('Memory Usage', 'FAIL', `Error: ${error.message}`);
                updateStatus(`❌ Memory usage test failed: ${error.message}`, 'error');
            }
        }
        
        function initializeDeviceGrid() {
            const gridDiv = document.getElementById('device-grid');
            const devices = [
                { name: 'iPhone 12', width: 390, height: 844 },
                { name: 'iPhone SE', width: 375, height: 667 },
                { name: 'Samsung Galaxy S21', width: 360, height: 800 },
                { name: 'iPad', width: 768, height: 1024 },
                { name: 'iPad Pro', width: 1024, height: 1366 }
            ];
            
            let html = '';
            devices.forEach(device => {
                html += `
                    <div class="device-card">
                        <h4>${device.name}</h4>
                        <div class="device-status status-pending">Pending</div>
                        <div>${device.width}x${device.height}</div>
                        <button onclick="testDevice('${device.name}')" class="test-button">Test Device</button>
                    </div>
                `;
            });
            
            gridDiv.innerHTML = html;
        }
        
        function testDevice(deviceName) {
            addTestResult(`Device Test: ${deviceName}`, 'PASS', `Testing ${deviceName} responsiveness`);
            updateStatus(`✅ Testing ${deviceName}...`, 'success');
        }
        
        function updateMobileData() {
            const dataDiv = document.getElementById('test-data-display');
            dataDiv.textContent = JSON.stringify(mobileData, null, 2);
        }
        
        // Listen for orientation changes
        window.addEventListener('orientationchange', () => {
            setTimeout(() => {
                testOrientation();
            }, 100);
        });
        
        // Listen for resize events
        window.addEventListener('resize', () => {
            testScreenSize();
        });
    </script>
</body>
</html>
